import{a6 as C,L as P,a7 as z,r as a,j as e,a as R}from"./index-jZLvl1ko.js";const I=()=>{const[c]=C(),m=P(),{user:A,login:E}=z(),[i,u]=a.useState(""),[d,x]=a.useState(""),[h,p]=a.useState(""),[o,f]=a.useState(!1),[g,r]=a.useState(""),[b,v]=a.useState(""),[l,k]=a.useState(!1);a.useEffect(()=>{c.get("from_reset")==="true"&&k(!0)},[c]);const L=s=>{const t=[];return s.length<8&&t.push("Lösenordet måste vara minst 8 tecken långt"),/[A-Z]/.test(s)||t.push("Lösenordet måste innehålla minst en stor bokstav"),/[a-z]/.test(s)||t.push("Lösenordet måste innehålla minst en liten bokstav"),/\d/.test(s)||t.push("Lösenordet måste innehålla minst en siffra"),/[!@#$%^&*(),.?":{}|<>]/.test(s)||t.push("Lösenordet måste innehålla minst ett specialtecken"),t},S=async s=>{var y,j,w;s.preventDefault(),r(""),v("");const t=L(d);if(t.length>0){r(t.join(". "));return}if(d!==h){r("Nya lösenorden stämmer inte överens");return}if(!l&&!i.trim()){r("Nuvarande lösenord krävs");return}f(!0);try{const n={new_password:d,...l?{}:{current_password:i}},N=await R.post("/api/v1/auth/change-password",n);N.data.success?(v("Lösenordet ändrades framgångsrikt! Du kommer att omdirigeras till din instrumentpanel."),u(""),x(""),p(""),setTimeout(()=>{m("/dashboard")},2e3)):r(N.data.message||"Misslyckades att ändra lösenord")}catch(n){console.error("Change password error:",n),((y=n.response)==null?void 0:y.status)===400?r(n.response.data.detail||"Ogiltiga lösenordskrav"):((j=n.response)==null?void 0:j.status)===401?r("Nuvarande lösenord är felaktigt"):((w=n.response)==null?void 0:w.status)===422?r("Lösenordsvalidering misslyckades. Vänligen kontrollera kraven."):r("Misslyckades att ändra lösenord. Vänligen försök igen.")}finally{f(!1)}};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:e.jsx("div",{className:"max-w-md w-full space-y-8",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("img",{src:"/logo192.png",alt:"Axie Studio logo",className:"mx-auto h-16 w-16 rounded-xl object-contain mb-4",onError:s=>{s.currentTarget.style.display="none",s.currentTarget.nextElementSibling.style.display="flex"}}),e.jsx("div",{className:"mx-auto h-16 w-16 bg-primary text-primary-foreground rounded-xl items-center justify-center mb-4 font-bold text-xl hidden",children:"AS"}),e.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:l?"Ange Nytt Lösenord":"Ändra Lösenord"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:l?"Skapa ett starkt lösenord för ditt konto":"Uppdatera ditt kontolösenord"})]}),b&&e.jsx("div",{className:"mb-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-green-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm font-medium text-green-800",children:b})})]})}),g&&e.jsx("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm font-medium text-red-800",children:g})})]})}),e.jsxs("form",{onSubmit:S,className:"space-y-6",children:[!l&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"current-password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Nuvarande Lösenord"}),e.jsx("input",{id:"current-password",name:"current-password",type:"password",value:i,onChange:s=>u(s.target.value),required:!l,disabled:o,className:"appearance-none relative block w-full px-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Ange ditt nuvarande lösenord"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"new-password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Nytt Lösenord"}),e.jsx("input",{id:"new-password",name:"new-password",type:"password",value:d,onChange:s=>x(s.target.value),required:!0,disabled:o,className:"appearance-none relative block w-full px-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Ange ditt nya lösenord"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirm-password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Bekräfta Nytt Lösenord"}),e.jsx("input",{id:"confirm-password",name:"confirm-password",type:"password",value:h,onChange:s=>p(s.target.value),required:!0,disabled:o,className:"appearance-none relative block w-full px-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Bekräfta ditt nya lösenord"})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Lösenordskrav:"}),e.jsxs("ul",{className:"text-xs text-gray-600 space-y-1",children:[e.jsx("li",{children:"• Minst 8 tecken långt"}),e.jsx("li",{children:"• Innehåller stora och små bokstäver"}),e.jsx("li",{children:"• Innehåller minst en siffra"}),e.jsx("li",{children:"• Innehåller minst ett specialtecken"})]})]}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:o,className:"group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-lg text-white bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200",children:o?e.jsxs("div",{className:"flex items-center",children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Ändrar Lösenord..."]}):"Ändra Lösenord"})})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx("button",{onClick:()=>m("/dashboard"),className:"text-sm text-blue-600 hover:text-blue-500 font-medium",children:"Tillbaka till Instrumentpanel"})})]})})})};export{I as default};
